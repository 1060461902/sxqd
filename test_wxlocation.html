<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>测试微信定位</title>
</head>
<script type="text/javascript" src="./assets/js/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="./assets/js/jweixin-1.2.0.js"></script>
<script>
    var latitude;
    var longitude;
    var accuracy;
    $(document).ready(function () {
        console.log(location.href);
        $.ajax({
            url:"../wx/config",
            type:"GET",
            data:{url:location.href},
            dataType:"json",
            success:function (data) {
                console.log(data.data);
                //微信验证
                wx.config({
                    appId:'wxb4a99366ee403d22',
                    timestamp:data.data.timestamp,
                    nonceStr:data.data.noncestr,
                    signature:data.data.signature,
                    jsApiList:[
                        "checkJsApi",
                        "getLocation"
                    ]
                });
                wx.checkJsApi({
                    jsApiList: [
                        'getLocation'
                    ],
                    success: function (res) {
                        if (res.checkResult.getLocation == false) {
                            alert('你的微信版本太低，不支持微信JS接口，请升级到最新的微信版本！');
                            return;
                        }
                    }
                });
                //微信验证完成调用
                wx.ready(function () {
                    wx.getLocation({
                        success:function (rs) {
                            latitude = rs.latitude; //维度
                            longitude = rs.longitude; //经度
                            console.log("维度:"+latitude+";"+"经度:"+longitude);
                        },
                        cancel:function (rs) {
                            alert("您拒绝提供位置信息");
                        }
                    })
                });
            }
        });
    });
</script>
<body>

</body>
</html>